---
layout: default
<!-- type: products -->
title: Demo
<!-- description: Start your day with our beverages. -->
permalink: /demo/
<!-- image: /assets/images/katya-austin-130044-unsplash.jpg -->
published: true
---

<section id="mix-master">
  <div class="container">
    <div class="row">
      <div class="col-lg-4"> 
        <div class="btn-group pull-left">
          <button id="30" class="btn btn-outline-primary" type="button" onclick="serving_container_toggle(30)">30</button>
  				<button id="60" class="btn btn-outline-primary" type="button" onclick="serving_container_toggle(60)">60</button>
          <button id="90" class="btn btn-outline-primary" type="button" onclick="serving_container_toggle(90)">90</button>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="btn-group pull-right" style="width: 100%">
          <input type="text" placeholder="Search.." style="width: 100%" id="search_input" onkeyup="search_function()" onclick="display_search()">
        </div>
      </div>
      <div class="col-lg-4">
        <div class="snipcart-add-item btn btn-outline-primary" id="add_to_cart_button" style="visibility: hidden;">Add to Cart
        </div>
        <div id="subtotal" style="float:right">Subtotal:</div>
      </div>
    </div>
  </div>
  
  <div class="container">
    <div class="row">
      <div class="col-lg-4">
        <div class="nutrition_label">
          <div class="nutrition-facts__header">
            <h1 class="nutrition-facts__title">Nutrition Facts</h1>
            <h6 id="serving_size">Serving Size: 1 scoop (0 g)</h6>
            <h6 id="serving_container">Serving Per Container: 30</h6>
          </div>
          <div class="nutrition-facts" id="nutrition_list">
            <table class="nutrition-facts__table" id="nutrition_table" style="width: 100%">
              <thead>
                <tr style="border-style: none;">
                  <th colspan="2">
                    <h6>Amount Per Serving</h6>
                  </th>
                  <td><h6 class="dv">% DV*</h6></td>
                </tr>
              </thead>
            </table>
            <h6 id="ingredients">Ingredients: </h6>
            <br>
            <h6>* Percent Daily Values are based on a 2,000 calorie diet. Your daily values may be higher or lower depending on your calorie needs.</h6>
            <br>
            <h6>† Percent Daily Value not determined.</h6>
          </div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="dropdown-content" id="selection_space"></div>
      </div>
      <div class="col-lg-4">
        <div class="supplements" id="supplement_list"></div>
      </div>
    </div>
  </div>

      <!-- Modal -->
  <div class="modal fade"
    id="id-{{item.id}}"
    tabindex="-1"
    role="dialog"
    aria-labelledby="id-{{item.id}}"
    aria-hidden="true"
  >
    <div class="modal-dialog" role="document">
      <div class="modal-content" id="info_blurb">
        <img src="{{item.image}}" alt="{{item.title}}" />
        <div class="modal-header">
          <h5 class="modal-title" id="modal_name"></h5>
        </div>
        <div class="modal-body">
          <p id="modal_description">Description:</p>
          <p><strong id=modal_price></strong></p>
          <p><strong id=modal_ingredients></strong></p>
          <p><strong id=modal_sans>Free of: </strong></p>
          <p><strong id="modal_url"></strong></p>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-sm btn-secondary"
            data-dismiss="modal"

          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <div class="modal fade"
    id="id-checkout_blurb"
    tabindex="-1"
    role="dialog"
    aria-labelledby="id-checkout_blurb"
    aria-hidden="true"
  >
    <div class="modal-dialog" role="document">
      <div class="modal-content" id="checkout_blurb">
        <img src="{{item.image}}" alt="{{item.title}}" />
        <div class="modal-header">
          <h5 class="modal-title" id="modal_name"></h5>
        </div>
        <div class="modal-body">
          <p id="modal_description">Description:</p>
          <p><strong id=modal_price></strong></p>
          <p><strong id=modal_ingredients></strong></p>
          <p><strong id=modal_sans>Free of: </strong></p>
          <p><strong id="modal_url"></strong></p>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-sm btn-secondary"
            data-dismiss="modal"

          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<script src="/assets/js/papaparse.js"></script> <!-- dunno where to put this -->

<script>

  var supplement_data = [];
  var nootropic_data = [];
  var flavor_data = [];
  var total_servings = 30;

  load_data();

  function load_data() {

    Papa.parse('/assets/data.csv',{
      header: true,
      newline: "\n",
      delimiter: ",",
      quoteChar: '"',
      dynamicTyping: true,
      download: true,
      complete: function(results){
      
        for (let i=0;i<results.data.length;i++){
          if (results.data[i].type=="supplement"){
            supplement_data.push(results.data[i]);
          }
          else if (results.data[i].type=="nootropic"){
            nootropic_data.push(results.data[i]);
          }
          else {
            flavor_data.push(results.data[i]);
          }
        }
      }
    });
  }

  function add_supplement(name) {

    var supplementList = document.getElementById('supplement_list');
    var nutritionList = document.getElementById('nutrition_list');

    let length = supplementList.children.length;
    let i;

    var slider_id = "slide_";
    slider_id = slider_id.concat(name);
    var minus = "minus_";
    minus = minus.concat(name);
    var plus = "plus_";
    plus = plus.concat(name);
    var delete_id = "delete_";
    delete_id = delete_id.concat(name);


    if (length==0){
      var do_we_add = 1; 
    }
    else{
      var do_we_add = 0;
    }

    for (i=0; i<length; i++){

      if (name==supplementList.children[i].localName){
        do_we_add = 0; 
        error_balloon();
        break;
      }
      else{
        do_we_add = 1;
      }
    }
    if (do_we_add==1){

      function getSupp(supp) { 
        return supp.name === name;
      }
      var supplement = supplement_data.find(getSupp);
      if (supplement === undefined) {
        supplement = flavor_data.find(getSupp);
      }

      var slidecontainer = document.createElement(supplement.name);
      supplement.slider_id = slider_id;
      slidecontainer.className = "supplement";
      slidecontainer.id = "supplement_cost";
      slidecontainer.innerHTML = '<h5 className="supplement_propername">'+supplement.propername+'</h5>';

      var buttoncontainer = document.createElement("button-container");
      buttoncontainer.className = "button-container btn-group";

      var slider_input = document.createElement("input");
      slider_input.className = "supplement_slider";
      slider_input.type = "range";
      slider_input.min = 0;
      slider_input.max = supplement.max;
      slider_input.step = supplement.step;
      slider_input.value = 0;
      slider_input.id = slider_id;

      var fixed = 1;
      if (slider_input.step == 1){
        fixed = 0;
      }

      var output = document.createElement("output");
      let output_id = "output_";
      output_id = output_id.concat(supplement.name);
      output.id = output_id;
      output.innerHTML = '<span>Amount: <span style="font-weight:bold;color:red"> 0 </span>' + supplement.unit + ' per serving</span>';
      output.className = "supplement_output";

      var output_price = document.createElement("output_price");
      let output_price_id = "output_price_";
      output_price_id = output_price_id.concat(supplement.name);
      output_price.id = output_price_id;
      output_price.innerHTML = '<span>Price: $<span style="font-weight:bold;color:red"</span>' + supplement.qty * supplement.price + '</span> per serving</span>';
      output_price.className = "supplement_output_price";

      var plus_input = document.createElement("input");
      plus_input.type = "button";
      plus_input.className = "btn btn-outline-primary supplement_plus";
      plus_input.id = plus;
      plus_input.value = "+";

      var minus_input = document.createElement("input");
      minus_input.type = "button";
      minus_input.className = "btn btn-outline-primary supplement_minus";
      minus_input.id = minus;
      minus_input.value = "-";

      var delete_input = document.createElement("input");
      delete_input.type = "button";
      delete_input.className = "btn btn-outline-primary supplement_delete";
      delete_input.id = delete_id;
      delete_input.value = "∅";
      
      minus_input.addEventListener('click', event => {
        event.preventDefault();
        if (supplement.qty > 0) {
          supplement.qty = (Number(supplement.qty) || 0) - Number(supplement.step);
          slider_input.value = supplement.qty;
        }
        update_amt(supplement, output);
        update_supplement_cost(supplement);
        update_serving_size();
        sort_ingredients();
      });

      plus_input.addEventListener('click', event => {
        event.preventDefault();
        if (supplement.qty < supplement.max) {
          supplement.qty = (Number(supplement.qty) || 0) + Number(supplement.step);
          slider_input.value = supplement.qty;
        }
        update_amt(supplement, output);
        update_supplement_cost(supplement);
        update_serving_size();
        sort_ingredients();
      });

      delete_input.addEventListener('click', event => {
        event.preventDefault();
        supplement.qty = 0;
        document.getElementById(supplement.name).remove();
        let find_label_stuff = "dv_";
        find_label_stuff = find_label_stuff.concat(supplement.name);
        document.getElementById(find_label_stuff).parentElement.remove();
        delete_input.parentElement.parentElement.remove();
        update_serving_size();
        update_supplement_cost(supplement);
        sort_ingredients();
        toggle_add_to_cart_button();
      });

      buttoncontainer.appendChild(minus_input);
      buttoncontainer.appendChild(delete_input);
      buttoncontainer.appendChild(plus_input);

      slidecontainer.appendChild(slider_input);
      slidecontainer.appendChild(output_price);
      slidecontainer.appendChild(buttoncontainer);
      slidecontainer.appendChild(output);
      
      supplementList.appendChild(slidecontainer, slider_id);

      supplement.slider_value = document.getElementById(supplement.slider_id);
      supplement.qty = 0;

      supplement.slider_value.oninput = function() {

      supplement.qty = Number(this.value);
      update_serving_size();
      update_amt(supplement, output);
      sort_ingredients();
      update_supplement_cost(supplement, output_price);
      }
    }
    add_label(supplement);
    toggle_add_to_cart_button();
  }

  function add_label(supplement){
    let index = 0;
    let table = document.getElementById("nutrition_table");
    let row = table.insertRow(index+1);
    let cell1 = row.insertCell(0);
    let cell2 = row.insertCell(1);
    let cell3 = row.insertCell(2);
    cell1.innerHTML = '<span style="font-weight:bold">' + supplement.propername + ': </span>' + supplement.qty + ' ' + supplement.unit;
    cell1.id = supplement.name;
    let cell2_id = "space_";
    cell2_id = cell2_id.concat(supplement.name);
    cell2.id = cell2_id;
    let cell3_id = "dv_";
    cell3_id = cell3_id.concat(supplement.name);
    cell3.id = cell3_id;
  }

  function add_to_cart(){

  }

  function display_search(){
    supplement_data.sort((a, b) => {
      return a.id - b.id;
    });

    let x = document.getElementById("selection_space");
    x.style.position = "inherit";
    x.style.display = "block";
    let y ="<div class='container'>";
    let i;
    for (i=0; i<=(supplement_data.length-1); i++) {
      y = y + "<b class='row'><a onclick=add_supplement('" + supplement_data[i].name + "')>" + supplement_data[i].propername + "</a>";
      y = y + "<info_icon style='font-size:12px' data-toggle='modal' data-target='#id-{{item.id}}' onclick=toggle_info_blurb('"+supplement_data[i].name+"') class='fa modal-info-icon'>&#xf05a;</info_icon></b>";
    }
    document.getElementById("selection_space").innerHTML = y + "</div>";
    x.index = 1;
  }

  function error_balloon(){
    var popup = document.getElementById("errorPopup_01");
    popup.classList.toggle("show");
    if(popup.classList.contains("show"))
      setTimeout(() => popup.classList.remove("show"), 1000)
  }

  function search_function(){
    let input, filter, ul, li, a, i;
    input = document.getElementById("search_input");
    filter = input.value.toUpperCase();
    div = document.getElementById("selection_space");
    a = div.getElementsByTagName("a");
    for (i = 0; i < a.length; i++) {
      txtValue = a[i].textContent || a[i].innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        a[i].style.display = "";
      } else {
        a[i].style.display = "none";
      }
    }
  }

  function serving_container_toggle(val) {
    total_servings=val;
    document.getElementById("serving_container").innerHTML='<h6>Serving Per Container: ' + val + '</h6>';
    update_subtotal();
    if (val==30){
      document.getElementById("30").className="btn btn-secondary";
      document.getElementById("60").className="btn btn-outline-primary";
      document.getElementById("90").className="btn btn-outline-primary";
    }
    else if (val==60){
      document.getElementById("30").className="btn btn-outline-primary";
      document.getElementById("60").className="btn btn-secondary";
      document.getElementById("90").className="btn btn-outline-primary";
    }
    else {
      document.getElementById("30").className="btn btn-outline-primary";
      document.getElementById("60").className="btn btn-outline-primary";
      document.getElementById("90").className="btn btn-secondary";
    }
  }

  function sort_ingredients(){
    supplement_data.sort(function(a, b){return b.qty - a.qty});
    let ingredient_list = "Ingredients: ";
    for (i=0;i<supplement_data.length;i++){
      if (supplement_data[i].qty > 0) {
        ingredient_list = ingredient_list + supplement_data[i].propername + ", ";
      }
    }
    ingredient_list = ingredient_list.substr(0, ingredient_list.length-2);
    document.getElementById("ingredients").innerHTML = ingredient_list;
  }
  
  function toggle_add_to_cart_button() {
    let x = document.getElementById("supplement_list");
    let y = document.getElementById("add_to_cart_button");
    if (x.childElementCount>0){
      y.style="visibility: visible;";
    }
    else{
      y.style="visibility: hidden;";
    }
  }

  function toggle_info_blurb(name){
    function getSupp(supp) { 
      return supp.name === name;
    }
    var supplement = supplement_data.find(getSupp);
    if (supplement === undefined) {
      supplement = flavor_data.find(getSupp);
    } 
    let x = document.getElementById("info_blurb");
    document.getElementById("modal_name").innerHTML=supplement.propername;
    document.getElementById("modal_price").innerHTML="Price: $" + supplement.price +"/"+supplement.unit;
    document.getElementById("modal_ingredients").innerHTML="Ingredients: " + supplement.ingredients;
    document.getElementById("modal_sans").innerHTML="Free of: "+supplement.sans;
    document.getElementById("modal_url").innerHTML="<a href="+supplement.url+" target='_blank' ><u>Click here for more information</u></a>";
  }

  function update_amt(supplement, output) {
    var cell1 = document.getElementById(supplement.name);

    if (supplement.unit == "mg"){
      output.innerHTML = '<span>Amount:' + '<span style="font-weight:bold;color:red"> ' + parseFloat(supplement.qty*1000).toFixed(0)  + '</span> ' + supplement.unit + ' per serving</span>';
      cell1.innerHTML = '<span style="font-weight:bold">' + supplement.propername + ': </span>' + parseFloat(supplement.qty*1000).toFixed(0) + ' ' + supplement.unit;
    }
    else{
      output.innerHTML = '<span>Amount:' + '<span style="font-weight:bold;color:red"> ' + parseFloat(supplement.qty).toFixed(1)  + '</span> ' + supplement.unit + ' per serving</span>';
      cell1.innerHTML = '<span style="font-weight:bold">' + supplement.propername + ': </span>' + parseFloat(supplement.qty).toFixed(1) + ' ' + supplement.unit;
    }
    
    var cell3_id = "dv_";
    cell3_id = cell3_id.concat(supplement.name);
    var cell3 = document.getElementById(cell3_id);

    if (isNaN(supplement.dv)){
      cell3.innerHTML = "<div class='dv'>" +'†';
    }
    else{
      cell3.innerHTML = "<div class='dv'>" + parseFloat((supplement.qty/supplement.dv)*100 ).toFixed(0)+ ' %' + "</div>";
    }
  }

  function update_serving_size(){
    let serving_size = document.getElementById("serving_size");
    let i = 0;
    let serving_size_amt = 0;
    for (i=0;i<supplement_data.length;i++){
      serving_size_amt = Number(serving_size_amt) + Number(supplement_data[i].qty);
    }
    for (i=0;i<flavor_data.length;i++){
      if (flavor_data[i].qty === undefined) {
        serving_size_amt = Number(serving_size_amt) + 0;
      }
      else{
        serving_size_amt = Number(serving_size_amt) + Number(flavor_data[i].qty);

      }
    }
    serving_size.innerHTML ='<h6>Serving Size: 1 scoop (' + parseFloat(serving_size_amt).toFixed(1) + ' g)</h6>';
  }

  function update_subtotal(){
    let subtotal = document.getElementById("subtotal");
    let i = 0;
    let serving_size_amt = 0;
    for (i=0;i<supplement_data.length;i++){
      serving_size_amt = Number(serving_size_amt) + Number(supplement_data[i].qty * supplement_data[i].price);
    }

    subtotal.innerHTML ='<h6>Subtotal: $' + parseFloat(serving_size_amt*total_servings).toFixed(2) + '</h6>';
  }

  function update_supplement_cost(supplement){

    let output_price_id = "output_price_";
    output_price_id = output_price_id.concat(supplement.name);
    x=document.getElementById(output_price_id);
    x.innerHTML = '<span>Price: $<span style="font-weight:bold;color:red"</span>' + parseFloat(supplement.qty * supplement.price).toFixed(2) + '</span> per serving</span>';
    update_subtotal();
  }

</script>